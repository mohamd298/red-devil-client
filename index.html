<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Красный дьявол</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="box">
  <h2>Красный дьявол</h2>
  <input id="username" placeholder="اسمك">
  <button onclick="login()">تسجيل دخول</button>
  <div class="spinner" id="spin" style="display:none"></div>
  <div id="err"></div>
</div>

<script>
const API = "https://red-devil-server.onrender.com";

async function login() {
  const u = username.value.trim();
  if (!u) return err.textContent = "اكتب اسمك";

  spin.style.display = "block";
  err.textContent = "";

  try {
    const res = await fetch(API + "/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username: u })
    });

    const data = await res.json();
    localStorage.setItem("token", data.token);
    location.href = "profile.html";

  } catch (e) {
    err.textContent = "❌ فشل الاتصال بالسيرفر";
  }

  spin.style.display = "none";
}
</script>
</body>
</html>
